<div class="container-fluid">
  <nav aria-label="breadcrumb" class="mb-3">
    <ol class="breadcrumb">
      <li class="breadcrumb-item">
        <a routerLink="/trabajadores" style="cursor:pointer;">
          <i class="bi bi-house-door"></i>
        </a>
      </li>
      <li class="breadcrumb-item active" aria-current="page">Trabajadores</li>
    </ol>
  </nav>

  <h2 class="fw-bold mb-4">Trabajadores</h2>

  <div class="card shadow-sm" style="max-width:1100px;">
    <div class="card-body">
      @if (errorMessage) {
        <div class="alert alert-danger" role="alert">
          {{ errorMessage }}
        </div>
      }
      
      <form [formGroup]="trabajadorForm" (ngSubmit)="guardar()" novalidate>
        <div class="row g-3">
          <div class="col-md-6">
            <label class="form-label fw-semibold">Nombre *</label>
            <input
              type="text"
              formControlName="nombre"
              class="form-control"
              placeholder="Escribe aquí el nombre"
              [class.is-invalid]="f.nombre.touched && f.nombre.invalid">
            @if (f.nombre.touched && f.nombre.invalid) {
              <div class="invalid-feedback">Nombre requerido mínimo 2 caracteres</div>
            }
          </div>
          <div class="col-md-6">
            <label class="form-label fw-semibold">Apellido *</label>
            <input 
              type="text"
              formControlName="apellido"
              class="form-control"
              placeholder="Escriba aquí el apellido"
              [class.is-invalid]="f.apellido.touched && f.apellido.invalid">
            @if (f.apellido.touched && f.apellido.invalid) {
              <div class="invalid-feedback">Apellido requerido mínimo 2 caracteres</div>
            }
          </div>
        </div>

        <div class="row g-3 mt-1">
          <div class="col-md-6">
            <label class="form-label fw-semibold">DNI *</label>
            <input
              type="text"
              formControlName="dni"
              class="form-control"
              placeholder="12345678A"
              [class.is-invalid]="f.dni.touched && f.dni.invalid">
            @if (f.dni.touched && f.dni.invalid) {
              <div class="invalid-feedback">DNI requerido (formato: 12345678A)</div>
            }
          </div>
          <div class="col-md-6">
            <label class="form-label fw-semibold">Email *</label>
            <input
              type="email"
              formControlName="email"
              class="form-control"
              placeholder="ejemplo@correo.com"
              [class.is-invalid]="f.email.touched && f.email.invalid">
            @if (f.email.touched && f.email.invalid) {
              <div class="invalid-feedback">Email válido requerido</div>
            }
          </div>
        </div>

        <div class="row g-3 mt-1">
          <div class="col-md-6">
            <label class="form-label fw-semibold">Teléfono</label>
            <input
              type="text"
              formControlName="telefono"
              class="form-control"
              placeholder="612345678"
              [class.is-invalid]="f.telefono.touched && f.telefono.invalid">
            @if (f.telefono.touched && f.telefono.invalid) {
              <div class="invalid-feedback">Teléfono de 9 dígitos</div>
            }
          </div>
          <div class="col-md-6">
            <label class="form-label fw-semibold">Rol *</label>
            <select
              formControlName="rol"
              class="form-control"
              [class.is-invalid]="f.rol.touched && f.rol.invalid">
              <option value="trabajador">Trabajador</option>
              <option value="supervisor">Supervisor</option>
              <option value="administrador">Administrador</option>
            </select>
            @if (f.rol.touched && f.rol.invalid) {
              <div class="invalid-feedback">Rol requerido</div>
            }
          </div>
        </div>

        <div class="row g-3 mt-1">
          <div class="col-md-6">
            <label class="form-label fw-semibold">Fecha Alta *</label>
            <input
              type="date"
              formControlName="fechaAlta"
              class="form-control"
              [class.is-invalid]="f.fechaAlta.touched && f.fechaAlta.invalid">
            @if (f.fechaAlta.touched && f.fechaAlta.invalid) {
              <div class="invalid-feedback">La fecha es obligatoria</div>
            }
          </div>
        </div>

        <div class="d-flex justify-content-end gap-3 mt-4">
          <button type="button" class="btn btn-outline-primary" (click)="atras()" [disabled]="isLoading">
            ATRÁS
          </button>
          <button
            type="submit"
            class="btn btn-primary"
            [disabled]="isLoading">
            @if (isLoading) {
              <span>GUARDANDO...</span>
            } @else {
              <span>GUARDAR</span>
            }
          </button>
        </div>
      </form>
    </div>
  </div>
</div>
